---
import { Icon } from 'astro-icon/components'

const currentPath = Astro.url.pathname
---

<header class="backdrop-blur-md fixed w-full z-20 top-0 left-0">
  <nav class="container px-2 lg:max-w-[1114px] flex flex-wrap items-center justify-between mx-auto py-4 ">
    <a class="flex text-main-color gap-2 items-center self-center text-3xl font-black whitespace-nowrap" href="/">
      JC
    </a>
    <div class="md:order-2">
      <ul class={`${currentPath === "/projects" ? "flex items-center" : "hidden md:flex md:items-center"} gap-8`}>
        <li>
          <a href="https://www.linkedin.com/in/franki-jhan-carlos-narvaez-munoz-a04bb0319/" target="_blank" aria-label="Visit my LinkedId profile">
            <Icon name='linkedin' size={15} class='text-gray-black dark:text-white-color hover:scale-110 transition-all duration-300'/>
          </a>
        </li>
        <li>
          <a href="https://github.com/FrankiNarvaez" target="_blank"  aria-label="Visit my Github profile">
            <Icon name='GitHub' size={15} class='text-gray-black  dark:text-white-color hover:scale-110 transition-all duration-300'/>
          </a>
        </li>
        <li class="flex items-center">
          <button class="rounded-md hover:scale-110 transition-all duration-300" title="Theme switcher button">
            <Icon name="light" size={15} class='text-gray-black dark:text-white-color'/>
          </button>
        </li>        
      </ul>
      <div class={`flex items-center ${currentPath === "/projects" ? "hidden" : "md:hidden"}`}>
        <button class="p-1 rounded-md" title="Theme switcher button">
          <Icon name="light" size={15} class='text-gray-black dark:text-white-color'/>
        </button>
        <button class="p-2 text-sm rounded-lg" title="Menu nav">
          <Icon name='menu' size={20} class='text-gray-black dark:text-white-color' />
        </button>
      </div>
    </div>
    { currentPath != "/projects" && (  
      <div class="items-center justify-between w-full md:flex md:w-auto md:order-1 transition-all duration-500 hidden">
        <ul class="flex flex-col gap-10 p-4 md:p-0 mt-4 font-medium  md:flex-row  md:mt-0 md:border-0 text-gray-black dark:text-white-color dark:font-normal">
          <li class="text-center">
            <a href="#Home" class="hover:underline">
              Home
            </a>
          </li>
          <li class="text-center">
            <a href="#Projects" class="hover:underline">
              Projects
            </a>
          </li>
          <li class="text-center">
            <a href="#About" class="hover:underline">
              About me
            </a>
          </li>
          <li class="text-center">
            <a href="#Contact" class="hover:underline">
              Contact
            </a>
          </li>
        </ul>
        <ul class="flex justify-center space-x-8 my-4 md:hidden">
          <li>
            <a href="https://www.linkedin.com/in/franki-jhan-carlos-narvaez-munoz-a04bb0319/" target="_blank">
              <Icon name='linkedin' size={15} class='text-gray-black dark:text-white-color'/>
            </a>
          </li>
          <li>
            <a href="https://github.com/FrankiNarvaez" target="_blank">
              <Icon name='GitHub' size={15} class='text-gray-black dark:text-white-color'/>
            </a>
          </li>
        </ul>
      </div>
    )}
  </nav>
</header>

<script>
  // Modo oscuro
  const themeToggleButtons = document.querySelectorAll('button[title="Theme switcher button"]');

  themeToggleButtons.forEach(button => {
    button.addEventListener('click', () => {
      if (document.documentElement.classList.contains('dark')) {
        document.documentElement.classList.remove('dark');
        localStorage.setItem('theme', 'light');
      } else {
        document.documentElement.classList.add('dark');
        localStorage.setItem('theme', 'dark');
      }
    });
  });

  // Configuración inicial del tema según el localStorage o el sistema
  const currentTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');

  if (currentTheme === 'dark') {
    document.documentElement.classList.add('dark');
  } else {
    document.documentElement.classList.remove('dark');
  }

  // Lógica para el menú, ya existente
  const menuButton = document.querySelector('button[title="Menu nav"]');
  const menuNav = document.querySelector('.items-center.justify-between.w-full.md\\:flex.md\\:w-auto.md\\:order-1.transition-all.duration-500');
  
  if (menuButton && menuNav) {
    menuButton.addEventListener('click', () => {
      menuNav.classList.toggle('hidden');
    });
  }
</script>
